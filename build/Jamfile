#  (C) Copyright William E. Kempf 2001. Permission to copy, use, modify, sell and
#  distribute this software is granted provided this copyright notice appears
#  in all copies. This software is provided "as is" without express or implied
#  warranty, and with no claim as to its suitability for any purpose.
#
# Boost.Threads build and test Jamfile
#
# Declares the following targets:
#   1. libboost_thread, a static link library.
#       1a. On Win32, a dynamic link library libboost_threadmon,
#           which must be used in conjunction with libboost_thread.

# declare the location of this subproject relative to the root
subproject libs/thread/build ;

# declare BUILD_THREADMON to 1 so that threads.jam knows what to do with <dll>boost_threadmon
BUILD_THREADMON = 1 ;

# include threads.jam for Boost.Threads global build information
SEARCH on <module@>threads.jam = $(BOOST_ROOT)/libs/thread/build ;
include <module@>threads.jam ;

#######################
# Declare the Boost.Threads static link library.

# Base names of the source files for libboost_thread
CPP_SOURCES =
    condition mutex recursive_mutex thread tss xtime once exceptions ;

lib boost_thread : ../src/$(CPP_SOURCES).cpp
    # requirements
    : <include>$(BOOST_ROOT)
    $(PTW32_REQUIREMENTS) # if using pthreads-win32
    <threading>multi
    : debug release ;

stage bin-stage : <lib>boost_thread $(BOOST_THREADMON_DLL)
    :
	<tag><runtime-link-static>"s"
        <tag><debug>"d"
    :
        debug release
    ;
