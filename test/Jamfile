#  (C) Copyright William E. Kempf 2001. Permission to copy, use, modify, sell and
#  distribute this software is granted provided this copyright notice appears
#  in all copies. This software is provided "as is" without express or implied
#  warranty, and with no claim as to its suitability for any purpose.
#
# Boost.Threads build and test Jamfile
#
# Declares the following targets:
#   1. test_thread, a unit test executable.
#
# Invoke with:
#   Jam [-sPTW32=lib]
#     Where: lib == name of pthreads-win32 link library
#     Note: Not currently working completely

# declare the location of this subproject relative to the root
subproject libs/thread/test ;

#######################

#
# Declare the Boost.Threads unit test program.
#

# Do some OS-specific setup
if $(NT)
{
    if $(PTW32)
    {
        PTW32_REQUIREMENTS = <define>BOOST_HAS_PTHREADS <define>PtW32NoCatchWarn ;
        BOOST_THREADMON_LIB = ;
    }
    else
    {
        BOOST_THREADMON_LIB = <lib>../build/libboost_threadmon ;
    }
}
else
{
    BOOST_THREADMON_LIB = ;
}

unit-test test_thread : test_thread.cpp
    <lib>../build/libboost_thread
    $(BOOST_THREADMON_LIB)
    # requirements
    : <include>$(BOOST_ROOT)
    $(PTW32_REQUIREMENTS)
    <threading>multi
    : debug release ;
